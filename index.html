<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>Network Topology</title>

    <!-- load brython libraries -->
    <script type="text/javascript" src="lib/brython.js"></script>
    <script type="text/javascript" src="lib/brython_stdlib.js"></script>

    <!-- load css -->
    <link rel="stylesheet" href="styles/basic.css">

    <!-- load python scripts -->
    <script type="text/plain" src="myfunctions.py"></script>

    <!-- gets rid of weird error: GEThttp://localhost:8000/favicon.ico -->
    <link rel="shortcut icon" href="#" />
</head>

<body onload="brython(1)">

<div id="container">
    <div id="content" class="clearfix">
        Content
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
        width="400" height="400" class="svg">
        <g id="draw"></g>
        </svg>
        Other Content
    </div>
    <div id="header">
        Header
    </div>
</div>

<script type="text/python">

    import math
    from browser import document, svg
    import myfunctions

    text_area = document['header']
    drawing_area = document['draw']
    
    def get_initial_rectangle():
        return svg.rect(x="0",y="0", width="400", height="400",stroke_width="2",fill="blue")

    def get_circle(x,y):
        return svg.circle(cx=x, cy=y, r=40,stroke="black",stroke_width="2",fill="red")

    background = get_initial_rectangle()
    circle1 = get_circle(100,100)
    circle2 = get_circle(300,300)

    drawing_area <= background

    def grab(ev):
            
        // find out which element we moused down on
        targetElement = ev.target;

        // you cannot drag the background itself, so ignore any attempts to mouse down on it
        if ( BackDrop != targetElement )
        {
        //set the item moused down on as the element to be dragged
        DragTarget = targetElement;

        // move this element to the "top" of the display, so it is (almost)
        //    always over other elements (exception: in this case, elements that are
        //    "in the folder" (children of the folder group) with only maintain
        //    hierarchy within that group
        DragTarget.parentNode.appendChild( DragTarget );

        // turn off all pointer events to the dragged element, this does 2 things:
        //    1) allows us to drag text elements without selecting the text
        //    2) allows us to find out where the dragged element is dropped (see Drop)
        DragTarget.setAttributeNS(null, 'pointer-events', 'none');

        // we need to find the current position and translation of the grabbed element,
        //    so that we only apply the differential between the current location
        //    and the new location
        var transMatrix = DragTarget.getCTM();
        GrabPoint.x = TrueCoords.x - Number(transMatrix.e);
        GrabPoint.y = TrueCoords.y - Number(transMatrix.f);
        }

    def mousedown1(ev):
        global drawing_area
        btn = ev.button
        text_area.text = f'you are clicking down on {ev.currentTarget.id} with {btn}'

    def mouseenter1(ev):
        global text_area
        text_area.text = f'entering {ev.currentTarget.id}'
    
    def mouseleave1(ev):
        global text_area
        text_area.text = f'leaving {ev.currentTarget.id}'
    
    def mousemove1(ev):
        global text_area
        text_area.text = f"coordinates : {ev.x}, {ev.y}"

    def get_star():
        return svg.polygon(fill="red", stroke="blue", stroke_width="10",
                           points=""" 75,38   90,80   135,80  98,107
                                      111,150 75,125  38,150  51,107
                                      15,80   60,80""")

    star = get_star()

    drawing_area <= circle1
    drawing_area <= circle2

    drawing_area.bind('mouseenter', mouseenter1)
    drawing_area.bind('mouseleave', mouseleave1)
    drawing_area.bind('mousemove', mousemove1)
    drawing_area.bind('mousedown', mousedown1)

</script>

</body>

</html>